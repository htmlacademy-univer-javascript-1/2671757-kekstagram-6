(function(global){'use strict';function closestParent(elem,className){if(!elem){return null;}if(typeof elem.closest==='function'){return elem.closest('.'+className);}while(elem){if(elem.classList&&elem.classList.contains(className)){return elem;}elem=elem.parentElement;}return null;}function createErrorElement(config){const error=document.createElement(config.errorTextTag||'div');error.className=config.errorTextClass||'pristine-error';return error;}function defaultConfig(){return{classTo:'form-group',errorClass:'has-error',successClass:'has-success',errorTextParent:'form-group',errorTextTag:'div',errorTextClass:'pristine-error-text'};}function Pristine(form,options){if(!form){throw new Error('Pristine requires a form element');}this.form=form;this.config=Object.assign({},defaultConfig(),options||{});this.fields=new Map();}Pristine.prototype.addValidator=function(field,validator,message,priority){const entry=this.fields.get(field)||{validators:[],errorElement:null};entry.validators.push({fn:validator,msg:message||'Invalid value',priority:priority||1});entry.validators.sort(function(a,b){return b.priority-a.priority;});this.fields.set(field,entry);};Pristine.prototype.validate=function(field){if(field){return this.validateField(field);}let valid=true;this.fields.forEach((_,key)=>{if(!this.validateField(key)){valid=false;}});return valid;};Pristine.prototype.validateField=function(field){const entry=this.fields.get(field);if(!entry||!entry.validators.length){return true;}const value=field.value;let result=true;for(let i=0;i<entry.validators.length;i++){const validator=entry.validators[i];if(!validator.fn(value,field)){this.showError(field,validator.msg,entry);result=false;break;}}if(result){this.removeError(field,entry);}return result;};Pristine.prototype.showError=function(field,message,entry){const parent=closestParent(field,this.config.classTo)||field.parentElement;const errorParent=closestParent(field,this.config.errorTextParent)||parent;if(parent){parent.classList.add(this.config.errorClass);parent.classList.remove(this.config.successClass);}if(!entry.errorElement){entry.errorElement=createErrorElement(this.config);errorParent.appendChild(entry.errorElement);entry.errorElement=entry.errorElement;}entry.errorElement.textContent=message;};Pristine.prototype.removeError=function(field,entry){const parent=closestParent(field,this.config.classTo)||field.parentElement;if(parent){parent.classList.remove(this.config.errorClass);parent.classList.add(this.config.successClass);}if(entry&&entry.errorElement){entry.errorElement.textContent='';}};Pristine.prototype.reset=function(field){if(field){const entry=this.fields.get(field);if(entry){this.removeError(field,entry);}}else{this.fields.forEach((entry,key)=>{this.removeError(key,entry);});}};global.Pristine=Pristine;})(typeof window!=='undefined'?window:this);

